<!-- Registration Success Modal -->
<div class="modal-backdrop fade-in" *ngIf="showSuccessModal" @fadeInOut>
  <div class="modal-dialog">
    <div class="modal-content success-modal">
      <div class="modal-icon">
        <svg viewBox="0 0 24 24" width="80" height="80" fill="#4BB543">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
        </svg>
      </div>
      <h3 class="modal-title">Registration Confirmed!</h3>
      <p class="modal-message">You're successfully registered for<br><strong>{{currentEventName}}</strong></p>
      <button class="modal-button success-btn" (click)="closeModal()">
        <span>Continue Exploring</span>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 12h14M12 5l7 7-7 7"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<!-- Already Registered Modal -->
<div class="modal-backdrop fade-in" *ngIf="showAlreadyRegisteredModal" @fadeInOut>
  <div class="modal-dialog">
    <div class="modal-content warning-modal">
      <div class="modal-icon">
        <svg viewBox="0 0 24 24" width="80" height="80" fill="#FFA000">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
        </svg>
      </div>
      <h3 class="modal-title">Registration Exists</h3>
      <p class="modal-message">You've already registered<br>for this event</p>
      <button class="modal-button warning-btn" (click)="closeModal()">
        <span>Got It</span>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<div class="main-container px-3 px-md-5">
  <div class="header-banner" style="margin-top: 30px;">
    <div class="d-flex justify-content-between align-items-center flex-wrap">

      <!-- Left: Title and Subtitle -->
      <div class="d-flex align-items-center">
        <div>
          <div class="d-flex text-center mb-1">
            <h1 class="header-title me-2 mb-0 league" style="font-size: 50px; margin-left: 90px;">üèüÔ∏è  SKILLSWAP EVENTS</h1>
          </div>
          <p class="header-subtitle mb-0 montserrat" style="font-size: 20px;padding: 20px;margin-left: 90px;margin-top: 30px;">Manage and organize all your events in one place</p>
        </div>
      </div>

      <!-- Right: Search Bar -->
      <div class="search-container mt-3 mt-md-0">
        <div class="search-input-wrapper" >
          <i class="bi bi-search search-icon"></i>
          <input
            type="text"
            [(ngModel)]="searchname"
            placeholder="Search events..."
            class="search-input"
          />
          <i class="bi bi-arrow-right arrow-icon"></i>
        </div>
      </div>

    </div>
  </div>
</div>

<br><br><br><br>

<section class="league text-center">
  <p class="mb-4" style="font-size: 50px;"><strong>EXPLORE OUR EVENTS</strong></p> <br>
  <p class="mb-4" style="font-size: 50px;"><strong>DISCOVER A NEW WORLD</strong></p>
</section>
<br><br><br><br>

<section class="features">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="feature-block d-flex justify-content-center flex-wrap gap-4"> 
          <!-- Card 1 -->
          <div class="feature-card"> 
            <button routerLink="/student/eventf" class="feature-button">
              <div class="feature-content">
                <span class="feature-icon">üé§</span>
                <span class="feature-text montserrat">ALL EVENTS</span>
              </div>
            </button>
          </div>
          
          <!-- Card 2 -->
          <div class="feature-card"> 
            <button routerLink="/student/topfiveeventf" class="feature-button">
              <div class="feature-content">
                <span class="feature-icon">üèÜ</span>
                <span class="feature-text montserrat">TOP 5 EVENTS</span>
              </div>
            </button>
          </div>
          
          <!-- Card 3 -->
          <div class="feature-card"> 
            <button routerLink="/student/eventregistrationsf" class="feature-button">
              <div class="feature-content">
                <span class="feature-icon">üìÖ</span>
                <span class="feature-text montserrat">MY REGISTRATIONS</span>
              </div>
            </button>
          </div>
          <div class="feature-card"> 
            <button routerLink="/student/eventchatbot" class="feature-button">
              <div class="feature-content">
                <span class="feature-icon">ü§ñ</span>
                <span class="feature-text montserrat">CHAT BOT</span>
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<br><br>

<div *ngIf="ratingMessage" class="alert alert-warning alert-dismissible fade show fixed-top-alert" role="alert">
  {{ ratingMessage }}
  <button type="button" class="btn-close" aria-label="Close" (click)="ratingMessage = null"></button>
</div>

<hr style="border: 1px solid #ddd; margin-top: 10px; margin-bottom: 30px;">

<div class="container mt-4">
  <br>

  <section style="margin-top: 10px;">
    <div class="row">
      <div class="col-lg-3 col-md-4 col-sm-6 col-12 mb-4" *ngFor="let event of onSearch(); let i = index" style="padding: 15px;">
        <div class="card custom-card shadow-sm" style="height: auto; max-width: 330px; margin: 0 auto;">
          <img [src]="event.posterURL" class="card-img-top" alt="Event Poster"
            style="height: 160px; object-fit: cover; width: 100%; max-height: 180px; border-radius: 8px;">
            <span class="event-type-badge" 
            [ngClass]="{'online': event.eventType === 'Online', 'live': event.eventType === 'Live'}">
              {{ event.eventType }}
            </span>
          <div class="card-body d-flex flex-column justify-content-center align-items-center text-center" style="padding: 10px;">
            <h5 class="card-title event-name" style="color: rgb(0, 0, 0); font-size: 1.3rem; font-weight: bold; margin-bottom: 15px;margin-top: 8px;">
              {{ event.eventName }}
            </h5>
            <p class="card-text event-text" style="color: #666; font-size: 1rem; line-height: 1.2; margin-bottom: 5px;">
              <strong>Starts:</strong> {{ event.eventStartDate | date:'mediumDate' }}<br>
              <strong>Ends:</strong> {{ event.eventEndDate | date:'mediumDate' }}<br>
              <strong>Register by:</strong> {{ event.registrationEndDate | date:'mediumDate' }}
            </p>
            <div class="d-flex justify-content-center gap-2 mt-3 buttons-container">
              <!-- Register Button - Disabled if registration closed or event already started -->
              <button class="btn btn-sm feedback montserrat" 
                      (click)="register(event.eventId)" 
                      [disabled]="isRegistrationClosed(event) || !isEventNotStarted(event)"
                      style="color: rgb(255, 255, 255); font-size: 0.8rem; padding: 6px 12px; border-radius: 20px;">
                <strong>Register</strong>
              </button>
              
              <!-- Feedback Button - Disabled if event hasn't started or feedback period is over -->
              <a [routerLink]="['/student/feedbackeventf', event.eventId]" 
                 class="btn btn-sm feedback" 
                 [class.disabled]="isEventNotStarted(event) || isFeedbackPeriodOver(event)"
                 style="font-style: normal; color: rgb(255, 255, 255); font-size: 0.8rem; padding: 6px 12px; border-radius: 20px;">
                <strong>Feedback</strong>
              </a>
              
              <button class="btn btn-sm feedback montserrat" 
                      routerLink="/student/eventdetailsf/{{ event.eventId }}" 
                      style="color: rgb(255, 255, 255); font-size: 0.8rem; padding: 6px 12px; border-radius: 20px;">
                <strong>Details</strong>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <br><br><br><br>
</div>
<section class="faq-section py-5" style="background: linear-gradient(to right, #f3dbff56, #ffbbe163);">
  <div class="container">
    <h2 class="text-center mb-5 montserrat" style="font-size: 2.5rem; color: #2c3e50;">Frequently Asked Questions</h2>
    
    <div class="accordion">
      <!-- FAQ Item 1 -->
      <div class="accordion-item mb-3">
        <h3 class="accordion-header">
          <button class="accordion-button collapsed montserrat" type="button" 
                  (click)="toggleAccordion(1)"
                  [attr.aria-expanded]="activeIndex === 1">
            How do I register for an event?
            <i class="bi bi-chevron-down ms-auto" [class.rotate]="activeIndex === 1"></i>
          </button>
        </h3>
        <div class="accordion-collapse" [class.show]="activeIndex === 1">
          <div class="accordion-body montserrat">
            Simply click the "Register" button on the event card. Make sure to register before the registration deadline.
          </div>
        </div>
      </div>


      <!-- FAQ Item 3 -->
      <div class="accordion-item mb-3">
        <h3 class="accordion-header">
          <button class="accordion-button collapsed montserrat" type="button" 
                  (click)="toggleAccordion(3)"
                  [attr.aria-expanded]="activeIndex === 3">
            When can I provide feedback for an event?
            <i class="bi bi-chevron-down ms-auto" [class.rotate]="activeIndex === 3"></i>
          </button>
        </h3>
        <div class="accordion-collapse" [class.show]="activeIndex === 3">
          <div class="accordion-body montserrat">
            Feedback can be provided starting from when the event begins until 7 days after the event ends.
          </div>
        </div>
      </div>

      <!-- FAQ Item 4 -->
      <div class="accordion-item mb-3">
        <h3 class="accordion-header">
          <button class="accordion-button collapsed montserrat" type="button" 
                  (click)="toggleAccordion(4)"
                  [attr.aria-expanded]="activeIndex === 4">
            Are there any fees for attending events?
            <i class="bi bi-chevron-down ms-auto" [class.rotate]="activeIndex === 4"></i>
          </button>
        </h3>
        <div class="accordion-collapse" [class.show]="activeIndex === 4">
          <div class="accordion-body montserrat">
            Most events are free, but some special workshops or premium events may have a fee. This will be clearly indicated on the event details page.
          </div>
        </div>
      </div>

      <!-- FAQ Item 5 -->
      <div class="accordion-item mb-3">
        <h3 class="accordion-header">
          <button class="accordion-button collapsed montserrat" type="button" 
                  (click)="toggleAccordion(5)"
                  [attr.aria-expanded]="activeIndex === 5">
            How do I know if my registration was successful?
            <i class="bi bi-chevron-down ms-auto" [class.rotate]="activeIndex === 5"></i>
          </button>
        </h3>
        <div class="accordion-collapse" [class.show]="activeIndex === 5">
          <div class="accordion-body montserrat">
            You'll see a confirmation popup immediately after registering, and you'll also receive a confirmation email. You can always check your registrations in the "My Registrations" section.
          </div>
        </div>
      </div>
    </div>
  </div>
</section><br>